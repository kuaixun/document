# 主页卡片

### **接口说明**  

主页卡片接口是导航版APP的首页数据获取接口。

### **实现逻辑**
#### 卡片属性
每个卡片都拥有一系列属性，用来控制卡片的展示和实现逻辑：

| 属性 | 说明 | 类型 |
| -- | -- | -- |
| id | 主键 | long |
| name | 卡片名称 | String |
| type | 卡片类型，用于唯一标识某种卡片实现，具体定义见卡片类型一节 | String |
| controls | 控制开关字段，由多个具体的控制项组成，每项占一个字节，目前从低位到高位分别表示是否可排序、是否可关闭显示，后续可扩展；举例如返回数字2，对应二级制10，则表示可关闭显示、不可排序 | int |
| index | 排序字段 | long |
| sortTime | 排序更新时间，实现待定 | long时间戳 |
| dataList | 数据项列表，不同的卡片对应的数据项列表字段可能不一样，详细数据项属性见卡片类型一节 | Object Array |
#### 卡片类型
卡片类型由产品定义，客户端通过接口返回的type字段来识别和实现相应的卡片布局；客户端内置支持一批卡片类型，不识别的卡片类型不显示，新增卡片类型或修改现有卡片布局需通过客户端升级完成。

目前客户端需支持的卡片类型如下：
##### 模块导航
* type定义：*nav*
* 需求说明  
  1.app主要模块导航位，图标、链接、排序后台均可配，固定展示，用户不可移除。  
  2.根据内容默认显示一行（5个+1个更多），点更多可下拉展示更多隐藏模块，最多展示2行11个；  
  3.如导航模块数量小于7，则不显示更多，反之才显示；  
  4.新闻-进入app底部资讯tab“热点”界面；视频-进入app底部视频tab首界面；其他-进入app底部导航对应栏目界面
* 实现说明  
  1.更多逻辑由客户端实现；  
  2.跳转TAB当前定义为1新闻TAB，2视频TAB；后面扩展的新TAB标识客户端应该判断并屏蔽；
* 字段定义

| 属性 | 说明 | 类型 |
| -- | -- | -- |
| id | 主键 | long |
| name | 显示名称 | String |
| icon | 显示图标http地址 | String |
| jumpType | 跳转类型,1TAB,2频道 | int |
| jumpTarget | 跳转目标,对应TAB标识、频道ID | String | 

##### 每日快讯  
* type定义：*news*
* 需求说明  
  1.每1小时自动获取快讯推荐频道最新28条入缓存（快讯/直投广告除外），按时间先后显示1-4条，点击换一换按顺序循环显示，每次4条；  
  2.第1条固定取小缩略图类型新闻展示（包含标题、缩略图、icon和来源），2-4条只单行展示新闻标题和icon，点击新闻区块进入新闻正文；  
  3.点击更多快讯，进入资讯tab的“推荐”频道；  
* 实现说明  
  1.更多快讯和换一换逻辑由客户端实现；  
  2.服务端控制只返回带缩略图的新闻；
* 字段定义  
参照接口返回[*findInfoNByCoid5*](findInfoNByCoid5.html)

##### 搞笑视频
* type定义：*funny*
* 需求说明  
  1.每1小时自动获取快讯视频类型最新20条（景点直播频道和非列表直接播放视频除外）入缓存，按时间先后显示1-4条，点击换一换按顺序循环显示，每次4条；  
  2.均以缩略图+标题形式展示，点击视频缩略图+标题区块进入对应页面；  
  3.点击更多视频，进入视频tab的首界面；  
* 实现说明  
  1.更多视频和换一换逻辑由客户端实现；  
  2.服务端控制只返回带缩略图的视频新闻；
* 字段定义  
参照接口返回[*findInfoNByCoid5*](findInfoNByCoid5.html)

##### 轻松一刻
* type定义：*joke*
* 需求说明  
  1.每1小时自动获取段子频道最新20条入缓存，按时间先后显示1条，点击换一换按顺序循环显示，每次1条；  
  2.均以纯文字形式展示，最多显示400字符（字数超过...），点击内容区域进入对应正文页；  
  3.点击更多笑料，进入资讯tab的段子频道列表；  
* 实现说明  
  1.更多笑料和换一换逻辑由客户端实现；  
* 字段定义  
参照接口返回[*findInfoNByCoid5*](findInfoNByCoid5.html)

##### 美女
* type定义：*beauty*
* 需求说明  
  1.每1小时自动获取美女频道最新20张图入缓存，按时间先后显示2张，点击换一换按顺序循环显示，每次2条；  
  2.2张图片可点，点击后进入资讯tab的美女频道对应图片的幻灯模式，点back返回美女列表；  
  3点击更多美图，进入资讯tab的美女频道列表；
* 实现说明  
  1.更多美图、幻灯片和换一换逻辑由客户端实现；  
* 字段定义  
参照接口返回[*findInfoNByCoid5*](findInfoNByCoid5.html)

##### 推荐站点
* type定义：*site*
* 需求说明  
  展示数量：  
  1.有数据时最多可显示4行28个（每行4组，每组最多显示8个字符）
  展示逻辑：  
  1.根据用户访问频次显示最近访问的28个常用网址，点击webview方式进入对应网址；  
  2.卡片内显示名称为网页title，排序根据用户最近访问（在app内）的时间由近及远显示；  
* 实现说明  
  1.访问频次排序由客户端实现；  
  2.添加的网页保存在客户端，由客户端控制；  
* 字段定义  

| 属性 | 说明 | 类型 |
| -- | -- | -- |
| id | 主键 | long |
| name | 网站名称 | String |
| icon | 网站图标http地址 | String |
| url | 网页地址 | String |

##### 实时热点
* type定义：*hot*
* 需求说明  
  1.每1小时自动获取快讯抓取百度热词接口最新20条入缓存，按时间先后显示1-6条，点击换一换按顺序循环显示，每次6条； 
  2.均以纯文字形式展示，每组至少能显示16个字符（超过字符...），单行显示，，点击单条热词进入对应热词百度搜索页面；  
  3.点击更多热点，进入导航搜索风云榜页面；
* 实现说明  
  1.换一换由客户端实现；  
  2.热词百度搜索页面和导航搜索风云榜页面地址通过配置对象字段返回；  
* 字段定义  

| 属性 | 说明 | 类型 |
| -- | -- | -- |
| id | 主键 | long |
| name | 热词名称 | String |

##### 小说
* type定义：*novel*
* 需求说明  
  1.推荐3本含封面小说+2条文字小说均通过后台人工配置更新； 
  2.点击更多小说，进入导航tab的小说频道列表；  
  3.点击换一换，更新上方5条后台配置的内容（后台可多配1-2倍对应数据）
* 实现说明  
  1.换一换由客户端实现；  
  2.热词百度搜索页面和导航搜索风云榜页面地址通过配置对象字段返回；  
* 字段定义  

| 属性 | 说明 | 类型 |
| -- | -- | -- |
| id | 主键 | long |
| name | 热词名称 | String |


|  |  | 1、<br>2、8个标签：标签后台可配置，点击进入对应标签的小说wap列表页或对应内容页；<br>3、<br>4、||
| ad | 图片广告 | 预设广告类型卡片（不发布）||
| flow | 话费流量查询 | 1、调流量查询接口定期获取最新话费余额和流量余额数据<br>2、点击中间区块和更多查询进入个人中心话费流量查询详情页<br>3、点击刷新在卡片内刷新数据，同时显示卡片更新时间|||
| latest | 最常访问 | 展示数量：<br>1、无数据时显示“暂无访问记录”；<br>2、有数据时最多可显示4行16个（每行4组，每组最多显示8个字符）<br>展示逻辑：<br>1、根据用户访问频次显示最近访问的16个常用网址，点击webview方式进入对应网址；<br>2、卡片内显示名称为网页title，排序根据用户最近访问（在app内）的时间由近及远显示；| |
   
#### **请求说明**

* 请求方法 *findInfoNByCoidN*

    客户端需要根据频道接口[*findInfoCateN5*](findInfoCateN5.html)返回的isMixRecom字段来控制刷新逻辑，isMixRecom为1时使用*findInfoNByCoidN*，为0时使用*findInfoNByCoid5*；
    
    客户端需要在本地保存刷新得到的广告除外的新闻，并且在每次刷新时根据newsId**去重**，广告根据是否有adid字段来判断，有的即为广告；

* 请求参数

| 字段 | 说明 | 类型 | 必须 |
| -- | -- | -- | -- | -- | -- |
| coid | 频道ID | long | 是 |
| gesture | 刷新手势，0下拉，1上滑 | int | 是 |
| interval | 分频道下拉刷新(仅针对gesture为0)的请求间隔分钟数<br>客户端第一次请求传0，后面请求每次至少传1 | int  | 是 | 
| ts | 分频道新闻刷新(包括下拉和上滑)时间戳<br>客户端第一次请求时传空串，后面每一次请求使用上一次请求返回的值 | string | 是

* 返回参数

| 字段 | 说明 | 类型 | 父节点
| -- | -- | -- |
| news | 新闻列表，详细字段参照接口[*findInfoNByCoid5*](findInfoNByCoid5.html) | 对象数组 ||
| ts | 新闻刷新时间戳,由客户端下一次请求时传回 | string | | |

* 响应示例

```
{
    "res": {
        "reCode": "1", 
        "resMessage": "Operation is successful"
    }, 
    "news": [
        {
            "title": "8旬老人含泪打官司要儿子一家搬走:不养老还啃老", 
            "desc": "杭州的王阿姨八十多岁了,去年她打了生平第一场官司,要求同住的儿子一家搬出去,最近又到法院申请强制执行。", 
            "time": 1453945320000, 
            "source": "新华炫闻", 
            "content_url": "http://192.168.10.170:8091/images/4061/20160128/3777717/3777717.html", 
            "newsUrl": "http://xw.feedss.com/show/index?newsid=235388", 
            "isTop": 0, 
            "type": 1, 
            "open_type": 0, 
            "ctype": 0, 
            "is_energy": 0, 
            "comment_count": 0, 
            "imageScale": 1, 
            "intimacyDegree": 2000, 
            "rssId": 59233315, 
            "rssName": "搜狐猛图", 
            "rssIcon": "http://192.168.10.150:8090/hotpic/201503/04/source5923331520150304174215.jpg", 
            "rssSource": "1", 
            "showType": 1003, 
            "newsId": 3777717, 
            "channelId": 4061, 
            "webView": 0, 
            "content_type": 1
        }
    ], 
    "ts": "1453949923000,1453945321000,0,0"
}
```